'use strict';
const assert = require('assert');
const format = require('../');

// assert.equal(format([]), '');
// assert.equal(format(['']), '');
// assert.equal(format([[]]), '[]');
// assert.equal(format([{}]), '{}');
// assert.equal(format([null]), 'null');
// assert.equal(format([true]), 'true');
// assert.equal(format([false]), 'false');
// assert.equal(format(['test']), 'test');

// // // CHECKME this is for console.log() compatibility - but is it *right*?
// assert.equal(format(['bar', 'bar', 'baz']), 'bar bar baz');

const emptyObj = {}
assert.equal(format(emptyObj, []), emptyObj)
assert.equal(format(emptyObj, ['a', 'b', 'c']), '{} "b" "c" ')
assert.equal(format('', ['a']), '')

// ES6 Symbol handling
const symbol = Symbol('bar')
assert.equal(format(null, [symbol]), null);
assert.equal(format('bar', [symbol]), 'bar');
assert.equal(format('%s', [symbol]), 'Symbol(bar)');
assert.equal(format('%j', [symbol]), 'undefined');
assert.throws(function() {
  format('%d', [symbol]);
}, TypeError);

assert.equal(format('%d', [42.0]), '42');
assert.equal(format('%d', [42]), '42');
assert.equal(format('%f', [42.99]), '42.99');
assert.equal(format('%i', [42.99]), '42');
assert.equal(format('%s', [42]), '42');
assert.equal(format('%j', [42]), '42');

assert.equal(format('%d', [undefined]), '%d');
assert.equal(format('%s', [undefined]), 'undefined');
assert.equal(format('%j', [undefined]), '%j');


assert.equal(format('%d', [null]), '%d');
assert.equal(format('%i', [null]), '%i');
assert.equal(format('%s', [null]), 'null');
assert.equal(format('%j', [null]), 'null');


assert.equal(format('%d', ['42.0']), '42');
assert.equal(format('%d', ['42']), '42');
assert.equal(format('%i', ['42']), '42');
assert.equal(format('%i', ['42.99']), '42');
assert.equal(format('%s %i', ['bar', 42.99]), 'bar 42');
assert.equal(format('%d %d', ['42']), '42 %d');
assert.equal(format('%i %i', ['42']), '42 %i');
assert.equal(format('%i %i', ['42.99']), '42 %i');
assert.equal(format('bar %d', ['42']), 'bar 42');
assert.equal(format('%s', ['42']), '42');
// assert.equal(format('%j', ['42']), '"42"');

// assert.equal(format('%%s%s', ['bar']), '%sbar');

assert.equal(format('%s', []), '%s');
assert.equal(format('%s', [undefined]), 'undefined');
assert.equal(format('%s', ['bar']), 'bar');
assert.equal(format('%s', ['\"quoted\"']), '\"quoted\"');
assert.equal(format('%j', [{ s: '\"quoted\"' }]), '{\"s\":\"\\"quoted\\"\"}');
assert.equal(format('%s:%s', []), '%s:%s');
assert.equal(format('%s:%s', [undefined]), 'undefined:%s');
assert.equal(format('%s:%s', ['bar']), 'bar:%s');
assert.equal(format('%s:%s', ['bar', 'bar']), 'bar:bar');
assert.equal(format('%s:%s', ['bar', 'bar', 'baz']), 'bar:bar');
assert.equal(format('%s%s', []), '%s%s');
assert.equal(format('%s%s', [undefined]), 'undefined%s');
assert.equal(format('%s%s', ['bar']), 'bar%s');
assert.equal(format('%s%s', ['bar', 'bar']), 'barbar');
assert.equal(format('%s%s', ['bar', 'bar', 'baz']), 'barbar');

assert.equal(format('bar %s', ['bar']), 'bar bar')

assert.equal(format('bar %o', [{bar: 'bar'}]), 'bar {"bar":"bar"}')
assert.equal(format('bar %O', [{bar: 'bar'}]), 'bar {"bar":"bar"}')
assert.equal(format('bar %j', [{bar: 'bar'}]), 'bar {"bar":"bar"}')
assert.equal(format('bar %j %j', [{bar: 'bar'}]), 'bar {"bar":"bar"} %j')
assert.equal(format('bar %j', ['bar']), 'bar \'bar\'') // TODO: isn't this wrong?
assert.equal(format('bar %j', [function bar () {}]), 'bar bar')
assert.equal(format('bar %j', [function () {}]), 'bar <anonymous>')
assert.equal(format('bar %j', [{bar: 'bar'}, 'not-printed']), 'bar {"bar":"bar"}')
assert.equal(
  format('bar %j', [{ bar: 'bar' }], { stringify () { return 'REPLACED' } }),
  'bar REPLACED'
)
const circularObject = {}
circularObject.bar = circularObject
assert.equal(format('bar %j', [circularObject]), 'bar "[Circular]"')

// // assert.equal(format(['%%%s%%', 'hi']), '%hi%');
// // assert.equal(format(['%%%s%%%%', 'hi']), '%hi%%');

// (function() {
//   var o = {};
//   o.o = o;
//   assert.equal(format(['%j', o]), '[Circular]');
// })();

assert.equal(format('%%', ['bar']), '%')
assert.equal(format('bar %%', ['bar']), 'bar %')
assert.equal(format('bar %% %s', ['bar']), 'bar % bar')

assert.equal(format('%s - %d', ['bar', undefined]), 'bar - %d')
assert.equal(format('%s - %f', ['bar', undefined]), 'bar - %f')
assert.equal(format('%s - %i', ['bar', undefined]), 'bar - %i')
assert.equal(format('%s - %O', ['bar', undefined]), 'bar - %O')
assert.equal(format('%s - %o', ['bar', undefined]), 'bar - %o')
assert.equal(format('%s - %j', ['bar', undefined]), 'bar - %j')
assert.equal(format('%s - %s', ['bar', undefined]), 'bar - undefined')
assert.equal(format('%s - %%', ['bar', undefined]), 'bar - %')

assert.equal(format('%s - %d', ['bar', null]), 'bar - %d')
assert.equal(format('%s - %f', ['bar', null]), 'bar - %f')
assert.equal(format('%s - %i', ['bar', null]), 'bar - %i')
assert.equal(format('%s - %O', ['bar', null]), 'bar - null')
assert.equal(format('%s - %o', ['bar', null]), 'bar - null')
assert.equal(format('%s - %j', ['bar', null]), 'bar - null')
assert.equal(format('%s - %s', ['bar', null]), 'bar - null')
assert.equal(format('%s - %%', ['bar', null]), 'bar - %')

assert.equal(format('%d%d', [11, 22]), '1122')
assert.equal(format('%d%s', [11, 22]), '1122')
assert.equal(format('%d%o', [11, { aa: 22 }]), '11{"aa":22}')
assert.equal(format('%d%d%d', [11, 22, 33]), '112233')
assert.equal(format('%d%d%s', [11, 22, 33]), '112233')
assert.equal(format('%d%o%d%s', [11, { aa: 22 }, 33, 'sss']), '11{"aa":22}33sss')
assert.equal(format('%d%%%d', [11, 22]), '11%22')
assert.equal(format('%d%%%s', [11, 22]), '11%22')
